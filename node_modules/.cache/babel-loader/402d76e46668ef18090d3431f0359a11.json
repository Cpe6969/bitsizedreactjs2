{"ast":null,"code":"import _slicedToArray from\"C:/Users/franc/Downloads/BITE-SIZED/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Button,Row,Col,ListGroup,Image,Card}from'react-bootstrap';import{Link}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{PayPalButton}from'react-paypal-button-v2';import Message from'../components/Message';import Loader from'../components/Loader';import{getOrderDetails,payOrder,deliverOrder}from'../actions/orderActions';import{ORDER_PAY_RESET,ORDER_DELIVER_RESET}from'../constants/orderConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OrderScreen(_ref){var match=_ref.match,history=_ref.history;var orderId=match.params.id;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),sdkReady=_useState2[0],setSdkReady=_useState2[1];var orderDetails=useSelector(function(state){return state.orderDetails;});var order=orderDetails.order,error=orderDetails.error,loading=orderDetails.loading;var orderPay=useSelector(function(state){return state.orderPay;});var loadingPay=orderPay.loading,successPay=orderPay.success;var orderDeliver=useSelector(function(state){return state.orderDeliver;});var loadingDeliver=orderDeliver.loading,successDeliver=orderDeliver.success;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;if(!loading&&!error){order.itemsPrice=order.orderItems.reduce(function(acc,item){return acc+item.price*item.qty;},0).toFixed(2);}var addPayPalScript=function addPayPalScript(){var script=document.createElement('script');script.type='text/javascript';script.src='https://www.paypal.com/sdk/js?client-id=AdBpHPdb251WJxSmZV3FxvQDXQZN01hrF0albnLIrH5JmIQlCv5eWa46flZdI2pdpLOF22LKgxBE3FSy';script.async=true;script.onload=function(){setSdkReady(true);};document.body.appendChild(script);};useEffect(function(){if(!userInfo){history.push('/login');}if(!order||successPay||order._id!==Number(orderId)||successDeliver){dispatch({type:ORDER_PAY_RESET});dispatch({type:ORDER_DELIVER_RESET});dispatch(getOrderDetails(orderId));}else if(!order.isPaid){if(!window.paypal){addPayPalScript();}else{setSdkReady(true);}}},[dispatch,order,orderId,successPay,successDeliver]);var successPaymentHandler=function successPaymentHandler(paymentResult){dispatch(payOrder(orderId,paymentResult));};var deliverHandler=function deliverHandler(){dispatch(deliverOrder(order));};var download=function download(){window.location.href=order.download;};return loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{className:\"text-center\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Pay it now!\"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Premium:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",order.totalPrice]})]})}),!order.isPaid&&/*#__PURE__*/_jsxs(ListGroup.Item,{children:[loadingPay&&/*#__PURE__*/_jsx(Loader,{}),!sdkReady?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(PayPalButton,{amount:order.totalPrice,onSuccess:successPaymentHandler})]})]}),order.isPaid&&order.paymentMethod==='PayPal'&&/*#__PURE__*/_jsxs(\"h5\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"br\",{}),\"Enjoy! \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Bite-sized Samson, Ian Russel is Ready to Serve you!\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]})]})})})});}export default OrderScreen;","map":{"version":3,"names":["React","useState","useEffect","Button","Row","Col","ListGroup","Image","Card","Link","useDispatch","useSelector","PayPalButton","Message","Loader","getOrderDetails","payOrder","deliverOrder","ORDER_PAY_RESET","ORDER_DELIVER_RESET","jsx","_jsx","jsxs","_jsxs","OrderScreen","_ref","match","history","orderId","params","id","dispatch","_useState","_useState2","_slicedToArray","sdkReady","setSdkReady","orderDetails","state","order","error","loading","orderPay","loadingPay","successPay","success","orderDeliver","loadingDeliver","successDeliver","userLogin","userInfo","itemsPrice","orderItems","reduce","acc","item","price","qty","toFixed","addPayPalScript","script","document","createElement","type","src","async","onload","body","appendChild","push","_id","Number","isPaid","window","paypal","successPaymentHandler","paymentResult","deliverHandler","download","location","href","variant","children","className","Item","taxPrice","totalPrice","amount","onSuccess","paymentMethod"],"sources":["C:/Users/franc/Downloads/BITE-SIZED/frontend/src/screens/OrderScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Button, Row, Col, ListGroup, Image, Card } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { PayPalButton } from 'react-paypal-button-v2'\nimport Message from '../components/Message'\nimport Loader from '../components/Loader'\nimport { getOrderDetails, payOrder, deliverOrder } from '../actions/orderActions'\nimport { ORDER_PAY_RESET, ORDER_DELIVER_RESET } from '../constants/orderConstants'\n\nfunction OrderScreen({ match, history }) {\n    const orderId = match.params.id\n    const dispatch = useDispatch()\n\n\n    const [sdkReady, setSdkReady] = useState(false)\n\n    const orderDetails = useSelector(state => state.orderDetails)\n    const { order, error, loading } = orderDetails\n\n    const orderPay = useSelector(state => state.orderPay)\n    const { loading: loadingPay, success: successPay } = orderPay\n\n    const orderDeliver = useSelector(state => state.orderDeliver)\n    const { loading: loadingDeliver, success: successDeliver } = orderDeliver\n\n    const userLogin = useSelector(state => state.userLogin)\n    const { userInfo } = userLogin\n\n\n    if (!loading && !error) {\n        order.itemsPrice = order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0).toFixed(2)\n    }\n\n\n    const addPayPalScript = () => {\n        const script = document.createElement('script')\n        script.type = 'text/javascript'\n        script.src = 'https://www.paypal.com/sdk/js?client-id=AdBpHPdb251WJxSmZV3FxvQDXQZN01hrF0albnLIrH5JmIQlCv5eWa46flZdI2pdpLOF22LKgxBE3FSy'\n        script.async = true\n        script.onload = () => {\n            setSdkReady(true)\n        }\n        document.body.appendChild(script)\n    }\n\n    useEffect(() => {\n\n        if (!userInfo) {\n            history.push('/login')\n        }\n\n        if (!order || successPay || order._id !== Number(orderId) || successDeliver) {\n            dispatch({ type: ORDER_PAY_RESET })\n            dispatch({ type: ORDER_DELIVER_RESET })\n\n            dispatch(getOrderDetails(orderId))\n        } else if (!order.isPaid) {\n            if (!window.paypal) {\n                addPayPalScript()\n            } else {\n                setSdkReady(true)\n            }\n        }\n    }, [dispatch, order, orderId, successPay, successDeliver])\n\n\n    const successPaymentHandler = (paymentResult) => {\n        dispatch(payOrder(orderId, paymentResult))\n    }\n\n    const deliverHandler = () => {\n        dispatch(deliverOrder(order))\n    }\n\n      \n    const download = () => {\n        window.location.href = order.download;\n      };\n      \n      \n\n    return loading ? (\n        <Loader />\n    ) : error ? (\n        <Message variant='danger'>{error}</Message>\n    ) : (\n                <div>\n                    {/* <h1>Order: {order.Id}</h1> */}\n                    <Row>\n                       \n\n                        <Col className='text-center'>\n                            <Card>\n                                <ListGroup variant='flush'>\n                                    <ListGroup.Item>\n                                        <h2>Pay it now!</h2>\n                                    </ListGroup.Item>\n\n                                    <ListGroup.Item>\n                                        <Row>\n                                            <Col>Premium:</Col>\n                                            <Col>${order.itemsPrice}</Col>\n                                        </Row>\n                                    </ListGroup.Item>\n\n                                \n                                    <ListGroup.Item>\n                                        <Row>\n                                            <Col>Tax:</Col>\n                                            <Col>${order.taxPrice}</Col>\n                                        </Row>\n                                    </ListGroup.Item>\n\n                                    <ListGroup.Item>\n                                        <Row>\n                                            <Col>Total:</Col>\n                                            <Col>${order.totalPrice}</Col>\n                                        </Row>\n                                    </ListGroup.Item>\n\n\n                                    {!order.isPaid && (\n                                        <ListGroup.Item>\n                                            {loadingPay && <Loader />}\n\n                                            {!sdkReady ? (\n                                                <Loader />\n                                            ) : (\n                                                    <PayPalButton\n                                                        amount={order.totalPrice}\n                                                        onSuccess={successPaymentHandler}\n                                                    />\n                                                )}\n                                        </ListGroup.Item>\n                                    )}\n                                </ListGroup>\n                          \n\n\n               \n{order.isPaid && order.paymentMethod === 'PayPal' && (\n\n<h5 className='text-center'><br/>Enjoy! <br/><br/>Bite-sized Samson, Ian Russel is Ready to Serve you!<br/><br/></h5>\n)}\n\n\n\n\n            \n         \n                            </Card>\n                        </Col>\n                    </Row>\n                </div>\n            )\n}\n\nexport default OrderScreen\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}